# Student Information Database
# Matthew Tyler, David Stalmakov

import sqlite3

def main():
  conn = sqlite3.connect('student.db')
  cur = conn.cursor()

  #Create table
  cur.execute("""
    CREATE TABLE IF NOT EXISTS Students (
    student_id INTEGER PRIMARY KEY AUTOINCREMENT,
    id TEXT,
    name TEXT,
    address TEXT,
    major TEXT,
    gpa REAL,
    email TEXT,
    phone TEXT,
    favorite_food TEXT)
    """)
  conn.commit()

  quit_program = "n"
  while quit_program != "y":  # lowercase w in while and I added ! so until quit is not true the program will repeat
      display_menu()
      choice = input("Select a choice:")) # fixed spelling
      if choice == "1":
        display_record(conn)
      elif choice == "2":
        edit_record(conn)
      elif choice == "3":
        quit = "y"
      else:
        print("Invalid choice")
conn.close()

def display_record(conn):
    #Finish display module
    cur = conn.cursor()
    cur.execute(("SELECT * FROM Students")
    records = cur.fetchall()

    print("\n--- Student Records ---")
    for record in records:
        print(record)

# Allows the user to add a record


def add_record(conn):
    cur = conn.cursor()
    print("\nEnter new student information:")
    school_id = input("School ID: ")
    name = input("Name: ")
    address = input("Address: ")
    major = input("Major: ")

    while True:
        try:
            gpa = float(input("GPA: "))
            break
        except ValueError:
            print("Invalid GPA. Please enter a number.")

    email = input("Email: ")
    phone = input("Phone: ")
    favorite_food = input("Favorite Food: ")

    cur.execute("""
        INSERT INTO Students (school_id, name, address, major, gpa, email, phone, favorite_food)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?)
    """, (school_id, name, address, major, gpa, email, phone, favorite_food))
    conn.commit()
    print("Record added successfully.")

def edit_record(conn):
    #Finish edit_record module
    cur = conn.cursor()
    display_record(conn)
    editID = int(input("Enter which record you want to edit:"))

        print("\nSelect field to edit:")
        print("1. Student ID")
        print("2. Student Name")
        print("3. Student Address")
        print("4. Major")
        print("5. GPA")
        print("6. Email")
        print("7. Phone Number")
        Print("8. Favorite Food")

    choice = int(input("Select field to edit: "))
    new_value = input("Enter new value: ")

    fields = {
        1: "Student ID",
        2: "Student Name",
        3: "Student Address",
        4: "Major",
        5: "GPA",
        6: "Email",
        7: "Phone Number",
        8: "Favorite Food"
    }

    if choice in fields:
        cur.execute(
            f"UPDATE Students SET {fields[choice]} = ? WHERE student_id = ?",
            (new_value, editID)
        )
        conn.commit()
        print("Record updated successfully.")
    else:
        print("Selected an invalid field.")

# Allows the user to delete a record
def delete_record(conn):
    cur = conn.cursor()
    display_record(conn)

    try:
        delete_id = int(input("\nEnter the student_id of the record to delete: "))
    except ValueError:
        print("Invalid ID")
        return

    confirm = input("Are you sure you want to delete this record? (y/n): ")
    if confirm.lower() != "y":
        print("Deletion cancelled.")
        return

    cur.execute("DELETE FROM Students WHERE student_id = ?", (delete_id,))
    conn.commit()
    print("Record deleted successfully.")

# Displays the Menu
def display_menu():
    print("\n--- Student Database Menu ---")
    print("1. Display All Student Records")
    print("2. Add a New Student Record")
    print("3. Edit a Student Record")
    print("4. Delete a Student Record")
    print("5. Quit")

if __name__ == "__main__":
    main()
